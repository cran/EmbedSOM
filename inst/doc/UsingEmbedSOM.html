<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Mirek Kratochvil" />

<meta name="date" content="2025-01-31" />

<title>EmbedSOM basic embedding</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">EmbedSOM basic embedding</h1>
<h4 class="author">Mirek Kratochvil</h4>
<h4 class="date">2025-01-31</h4>



<div id="basic-embedding-with-embedsom" class="section level1">
<h1>Basic embedding with EmbedSOM</h1>
<div id="dataset" class="section level2">
<h2>Dataset</h2>
<p>We will embed a small dataset created from gaussian clusters
positioned in vertices of a 5-dimensional hypercube.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co">#create the seed dataset</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1024</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,n),<span class="fu">rep</span>(<span class="dv">1</span>,n)),<span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#add dimensions</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>) data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">dim</span>(data)[<span class="dv">1</span>]), <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">dim</span>(data)[<span class="dv">1</span>])),<span class="fu">rbind</span>(data,data))</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co">#scatter the points to clusters</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">+</span> <span class="fl">0.2</span><span class="sc">*</span><span class="fu">rnorm</span>(<span class="fu">dim</span>(data)[<span class="dv">1</span>]<span class="sc">*</span><span class="fu">dim</span>(data)[<span class="dv">2</span>])</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="fu">colnames</span>(data) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;V&#39;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span></code></pre></div>
<p>This looks relatively nicely from the side (each corner in fact hides
8 separate clusters):</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">plot</span>(data, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.2</span>))</span></code></pre></div>
<pre><code>## Warning in plot.xy(xy, type, ...): semi-transparency is not supported on this
## device: reported only once per page</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAABlBMVEUAAAD///+l2Z/dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEI0lEQVR4nO3d4XKrNhBAYfH+L50ZOzZgYx1YEIutc3406YwWyNdCfB01LYNVK9kXcPUEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEgg4GKl9TFtCxh2uXQJBAUBOg241bv4EFuuN8JBKo1McEEqi21lsM1j4e0J+f0n0DnX+4dgkENQbyGURT5fXvt/4ZMDtvMUggSCBIIKjhC8Xqw7hvoBWrBTr0cIkJBPmQhgSCBIIEggSCBIIEggSCBIIEggSCTgbyPemkw7VLIEggSCBIIEggSCBIIEggSCCo2R5F90nX1rqJE9aW53qBFtd2DDQ+WSqTHd9ik93PVaBu90lPmc45b3YhoEGgTwvL+GHVZHfPoKE8Hr7r3lXueZ+0t9jCwuP+wf8s0Mq7A2+kHwW6fbLCqJT5xx3nzS72DAKksvhp7LzZRR/SAtUW0k1Wyvtn0fNmtxlo1WOaX+78KNBxr/B+Fej882bnm/aQQJBAkECQQJBAkECQQJBA0MlAPb0nfdJ5sxMIEggSCBIIEggSCBIIagLkLldaW4Zet+CtXDtuHxJoca1AsNZbDNb2u8v1/PNmJxDUGMhnEE0J1Pq82QkENQL69Na8b9r/Ly7zjzsPl1mbF4o8JhCMdQ5U3j/bcbjUWj2DOt3lmnDe7ASCGgJVX+sIJBBPCHTGebMTCBIIEggSCBIIEghKA/qakoDip4IL2TO862sUCBIIEggSCBIIEggSCBII+po/G2QlECQQJBAkECQQJBAkECQQJBAkECQQdA5QmW5v3PIzhR2Tt5Eds6+HaNn0V8Fv/KFLePI+Mh7n2kDDuK1o+1cYmxxmv180/mWeBjSEgWKT85FvAtr2CApPjuPB2ddDtGz+ZQ71XXwHTY7jwdnXQzSqPB+z0zOFgLZNLqwWaHk8OLtnKHQSgeonmX2z3gQUmxxHgrOvh2jZ4zZ7PCq3vJCOTt7Hn8fYPjs9RPPK5DdabPuGG5+8je2YnR7CPicQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQdGGg/58VJ/+G4QsDDVOgtOv8AqDJX9Mu4po9/90Jb8044iKyTrymyfYpgZYSCCrDuAc48xou24r/HVX7a8g68apK+D/UOPASrlx5Xp9Ai43f3gVaTiBIoMsnECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBD0B7R3P4Tg/kpsAAAAAElFTkSuQmCC" /><!-- --></p>
<p>Linear dimensionality reduction doesn’t help much with seeing all 32
clusters:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">data.frame</span>(<span class="fu">prcomp</span>(data)<span class="sc">$</span>x), <span class="at">pch=</span><span class="st">&#39;.&#39;</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.2</span>))</span></code></pre></div>
<pre><code>## Warning in plot.xy(xy.coords(x, y), type = type, ...): semi-transparency is not
## supported on this device: reported only once per page</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Let’s use the non-linear EmbedSOM instead.</p>
</div>
<div id="getting-the-som-ready" class="section level2">
<h2>Getting the SOM ready</h2>
<p>EmbedSOM works on a self-organizing map that you need to create
first:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>map <span class="ot">&lt;-</span> EmbedSOM<span class="sc">::</span><span class="fu">SOM</span>(data, <span class="at">xdim=</span><span class="dv">24</span>, <span class="at">ydim=</span><span class="dv">24</span>)</span></code></pre></div>
<p>EmbedSOM provides some level of compatibility with FlowSOM that can
be used to simplify some commands. FlowSOM-originating maps and whole
FlowSOM object may be used as well:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>fs <span class="ot">&lt;-</span> FlowSOM<span class="sc">::</span><span class="fu">ReadInput</span>(<span class="fu">as.matrix</span>(<span class="fu">data.frame</span>(data)))</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>fs <span class="ot">&lt;-</span> FlowSOM<span class="sc">::</span><span class="fu">BuildSOM</span>(<span class="at">fsom=</span>fs, <span class="at">xdim=</span><span class="dv">24</span>, <span class="at">ydim=</span><span class="dv">24</span>)</span></code></pre></div>
<p><span class="math inline">\(24\times24\)</span> is the recommended
SOM size for getting something interesting from EmbedSOM – it provides a
good amount of detail, and still runs quite quickly.</p>
</div>
<div id="embedding" class="section level2">
<h2>Embedding</h2>
<p>When the SOM is ready, a matrix of 2-dimensional coordinates is
obtained using the <code>EmbedSOM</code> function:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>e <span class="ot">&lt;-</span> EmbedSOM<span class="sc">::</span><span class="fu">EmbedSOM</span>(<span class="at">data=</span>data, <span class="at">map=</span>map)</span></code></pre></div>
<p>Alternatively, FlowSOM objects are supported to be used instead of
<code>data</code> and <code>map</code> parameters in most EmbedSOM
commands:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>e <span class="ot">&lt;-</span> EmbedSOM<span class="sc">::</span><span class="fu">EmbedSOM</span>(<span class="at">fsom=</span>fs)</span></code></pre></div>
<p>Several extra parameters may be specified; e.g. the following code
makes the embedding a bit smoother and faster (but not necessarily
better). See the EmbedSOM paper for details on parameters.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>e <span class="ot">&lt;-</span> EmbedSOM<span class="sc">::</span><span class="fu">EmbedSOM</span>(<span class="at">data=</span>data, <span class="at">map=</span>map, <span class="at">smooth=</span><span class="dv">2</span>, <span class="at">k=</span><span class="dv">10</span>)</span></code></pre></div>
<p>Finally, <code>e</code> now contains the dimensionality-reduced 2D
coordinates of the original data that can be used for plotting.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">head</span>(e)</span></code></pre></div>
<pre><code>##      EmbedSOM1 EmbedSOM2
## [1,]  23.47801  13.42236
## [2,]  22.86703  12.98544
## [3,]  23.63919  14.31299
## [4,]  21.65178  12.51104
## [5,]  22.58825  13.94369
## [6,]  23.12144  13.64124</code></pre>
</div>
<div id="plotting-the-data" class="section level2">
<h2>Plotting the data</h2>
<p>The embedding can be plotted using the standard graphics function,
nicely showing all clusters next to each other.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">plot</span>(e, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.2</span>))</span></code></pre></div>
<pre><code>## Warning in plot.xy(xy, type, ...): semi-transparency is not supported on this
## device: reported only once per page</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAABlBMVEUAAAD///+l2Z/dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAFRUlEQVR4nO2dgXajKhQA8f9/+u1ro2KDDqIEAzNn26TJhZvMIgjSJkxySGj9Ap6OggAFAQoCFAQoCFAQoCBAQYCCAAUBCgIUBCgIUBCgIEBBgIIABQEKAhQEKAhQEKAgQEGAggAFAQoCFAQoCFAQoCBAQYCCAAUBCgIUBCgIUBCgIEBBgIIABQEKAhQEKAhQEKAgQEGAggAFAQoCFAQoCFAQoCBAQYCCAAUBCgIUBCgIUBCgIEBBgIIABQEKAhQEKAhQEKAgQEGAggAFAQoCFATcLCh8Da0E3VtdPRQEKAhQEPBhQef7vtbYggAFAQoCFAQoCFAQoCBAQcBZQetJ3rW32KugHzm/hhSUCow1fSZva4oETSgIZ1zdClpvjkqGsL29kLc1BZ306+agZEjeLcvbmvJhXkGFgVN8ZO22s04F5S73c9Dggm7M25rTo9g1MUMsuWa8PZ6Q9Czo56fjYZ4nJL0Lmo4FvUIO6u9aEB5jGROSbgVldbAZE5JOBeWOPjwh6VfQyYF6MEEN8rZGQcBpQTedCPcqaDlBvqqoU0GRFierqUAFQWBsRUGJQFsQBCqIAh3FKPCuFcFuBV1NN8KS63TDEdZtCwqv1VT7oHRgWL87iqUC44V4BSUC45MhBSUC4+s5CkoF/tNySwPqVtC8Du8oVh7YpLp6KAiofdnnct7WFLSgO7ZJ9yxo2cF6GD3qNuDozlHJgbcBryfSByUzVq47FpRx6XBwQVxq3G3A2cGjbgN+3V1nZPXztqaskw6ls/kR1qRD9PWBvK1REFDlEMuYsXUsKGsLFVbbs6BbohV0a3UNKT7EPpW3NVUmq3fmbU2d5Y4b87ZGQUBJH3Su4MW8rXHRHvCyD6AgoHyq4SG2E3jPWk7Pgj6btzXlFw4/lLc1RX3QhXQjLLnaSR8H2gdBoIIo0E76ONA+6GJgk+rqcXY2X1DyWt7WlAi6Y0FIQXflbY2CAAUBCgJckwYUBHiiCCgIqCRo5F9FyAoO29uL1bWkiqCMGZuC0sVGWJPOieVLIGMLGv1XET6atzUKAhQEKAhQEKAgQEFAM0FfQyNBJxI884kLkYU804OCSp+4EFnIMz0oqPSJC5GFPNODgkqfuBBZyDM9KKj0iQuRg6IgQEGAggAFAQoCFAQoCFAQoCBAQYCCgMqC9i4f7F1ZCIel0vXULVFX0O6H+h4KOvoo4ET9oWqJyoJeLykv7fKfu1cqXU2oWqK+oGSKvbRh+y23/oolWgnaubh5UtBc5lyJ8BWC0i28QNCptzvNvfPTBe3lPi/o3NtdiowiKOrWKx2U3y1o81EO39pJQ2e88/iJQft8iQcN8/snigfD/4nTPsqTTvycE8X9E/qjYT5/GrCckH/rVKMDFAQoCFAQoCBAQYCCAAUBCgIUBCgIUBCgIEBBgIIABQEKAhQEKAhQEKAgQEGAggAFAQoCFAS0E5T8IxrpC/lz+Fru985cUb0X+T2Cfj7qPazFpkXMIq7Sy6xTbU7m/c0L7w8u+6QiG392IQwuaLkzN5v/f1oFnfmDNydfZp1qczKvu5/CegBF7WJ5+2ETvNzGgqaeW9CrBWz3Nq2bwLYt5E1QmPoV9Opt5w433nz6vlNu7pnn0rOangVFLyEl5m2vZbxtLqz/xhT027rCRtAUgoLi27+PT2G1sdiZBhb0Jixsmkvcd03DCPrbaS9fs4n4lKB3QXNHM8UtJX0eFA/0f3+trFdBX4KCAAUBCgIUBCgIUBCgIEBBgIIABQEKAhQEKAhQEKAgQEGAggAFAQoCFAQoCFAQoCBAQcB/rtY9Mm6YME8AAAAASUVORK5CYII=" /><!-- --></p>
<p>EmbedSOM provides specialized plotting function which is useful in
many common use cases; for example for displaying density:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>EmbedSOM<span class="sc">::</span><span class="fu">PlotEmbed</span>(e, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">nbin=</span><span class="dv">100</span>)</span></code></pre></div>
<pre><code>## Warning in plot.xy(xy, type, ...): semi-transparency is not supported on this
## device: reported only once per page</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Or for seeing colored expression of a single marker
(<code>value=1</code> specifies a column number; column names can be
used as well):</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>EmbedSOM<span class="sc">::</span><span class="fu">PlotEmbed</span>(e, <span class="at">data=</span>data, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">alpha=</span><span class="fl">0.3</span>, <span class="at">value=</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## Warning in plot.xy(xy, type, ...): semi-transparency is not supported on this
## device: reported only once per page</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAABlBMVEUAAAD///+l2Z/dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAELklEQVR4nO3di3LaMBQAUen/f7od8EOmMhvJMrcouzMpCRUIztgyEEpTtrel6BvwvycQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQNBgofU1RQGOv7r4EggSCBIIEggSCBIIEggSCBIIEggSCBIJagfYnuNfu4qxAD5ynkEC1gSXTZ+aNrgsoC3Q2MO0nAlUHLkt0y2uR1+aNrv8wL1DnwJCru682oK6X+6/NG51AUPNR7CJM87zRdaxBQ5BmBnr85C4GAwV6M3DEPjYt0PXjV+O80TUf5j89b3Q+DoJ8qgEJBDUDjdi/WuaNrv2pxuH0/nmja12k959dpCsDBYKBpYpAlYFuQTBQIBroUYwGjnmiMTHQx+eNrg/ILehsYFre3uEaVB+Y9j89itUGlu8MEqgysHwwJFBlYPkGM4FqA/+yDNmApgVaf+XjUax/YMjV3ZdAkL/2gTq2oBFvk54ZaN103IJOBqbXM+6dN7ruLcg16HTgkFfMZgZqudT1eaPzcRDUA5T2Z2T3zxtd3yKdXKTPB6bi6wPzRicQ5C4G+TgI8jAPCQR172Kfmjc6n6xCvtwBCQT1rEFtF7w4b3S+aA95mIcEgvqfariLnQz0XxzCwDF3bWagIfdtYqAxQhMD+TgIBroGwUCBaKCL9PuBrkEXB4Zc3X21PpvvuOS1eaPrARrxgpBAo+aNTiBIIEggyNekIYEgHyhCAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQWFAX1MQ0HwJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBMUBVT9Eo3pzts+b3S/3/Ga9ovtu5PcAPf6r97RfLOf9//VM5xcdcDPvudqfzFyb+gxo+8TrQmPbkARazy+AHuftQC0feNN4M++52p/MvE793HmW3abYLra7nw6Dt9MSKM+8BS1bwHJafOV96UmvDBtQyvMCLavtuuCu3+eX08MmdQRKcwMVN6EGU55ulzgA5V8M9Ny60gEopyRQefp6fk67xqaTfzHQP2DpsLmUa1f+NUCvi/b2tUqUDwlmB1oXmlxuKfXHQeWBfvurPDfQlyQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkEPQHhp0/GPqXiG4AAAAASUVORK5CYII=" /><!-- --></p>
<p>(Notice that it is necessary to pass in the original data frame. When
working with FlowSOM, the same can be done using
<code>fsom=fs</code>.)</p>
<p>Or multiple markers:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>EmbedSOM<span class="sc">::</span><span class="fu">PlotEmbed</span>(e, <span class="at">data=</span>data, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">alpha=</span><span class="fl">0.3</span>, <span class="at">red=</span><span class="dv">2</span>, <span class="at">green=</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## Warning in plot.xy(xy, type, ...): semi-transparency is not supported on this
## device: reported only once per page</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAABlBMVEUAAAD///+l2Z/dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAELklEQVR4nO3di3LaMBQAUen/f7od8EOmMhvJMrcouzMpCRUIztgyEEpTtrel6BvwvycQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQNBgofU1RQGOv7r4EggSCBIIEggSCBIIEggSCBIIEggSCBIJagfYnuNfu4qxAD5ynkEC1gSXTZ+aNrgsoC3Q2MO0nAlUHLkt0y2uR1+aNrv8wL1DnwJCru682oK6X+6/NG51AUPNR7CJM87zRdaxBQ5BmBnr85C4GAwV6M3DEPjYt0PXjV+O80TUf5j89b3Q+DoJ8qgEJBDUDjdi/WuaNrv2pxuH0/nmja12k959dpCsDBYKBpYpAlYFuQTBQIBroUYwGjnmiMTHQx+eNrg/ILehsYFre3uEaVB+Y9j89itUGlu8MEqgysHwwJFBlYPkGM4FqA/+yDNmApgVaf+XjUax/YMjV3ZdAkL/2gTq2oBFvk54ZaN103IJOBqbXM+6dN7ruLcg16HTgkFfMZgZqudT1eaPzcRDUA5T2Z2T3zxtd3yKdXKTPB6bi6wPzRicQ5C4G+TgI8jAPCQR172Kfmjc6n6xCvtwBCQT1rEFtF7w4b3S+aA95mIcEgvqfariLnQz0XxzCwDF3bWagIfdtYqAxQhMD+TgIBroGwUCBaKCL9PuBrkEXB4Zc3X21PpvvuOS1eaPrARrxgpBAo+aNTiBIIEggyNekIYEgHyhCAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQWFAX1MQ0HwJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBMUBVT9Eo3pzts+b3S/3/Ga9ovtu5PcAPf6r97RfLOf9//VM5xcdcDPvudqfzFyb+gxo+8TrQmPbkARazy+AHuftQC0feNN4M++52p/MvE793HmW3abYLra7nw6Dt9MSKM+8BS1bwHJafOV96UmvDBtQyvMCLavtuuCu3+eX08MmdQRKcwMVN6EGU55ulzgA5V8M9Ny60gEopyRQefp6fk67xqaTfzHQP2DpsLmUa1f+NUCvi/b2tUqUDwlmB1oXmlxuKfXHQeWBfvurPDfQlyQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkEPQHhp0/GPqXiG4AAAAASUVORK5CYII=" /><!-- --></p>
<p>Or perhaps for coloring the clusters. The following example uses the
FlowSOM-style clustering to find the original 32 clusters in the
scattered data. If that works right, each cluster should have its own
color. (See FlowSOM documentation on how the meta-clustering works.)</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>n_clusters <span class="ot">&lt;-</span> <span class="dv">32</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>hcl <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(map<span class="sc">$</span>codes))</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>metaclusters <span class="ot">&lt;-</span> <span class="fu">cutree</span>(hcl,n_clusters)[map<span class="sc">$</span>mapping[,<span class="dv">1</span>]]</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>EmbedSOM<span class="sc">::</span><span class="fu">PlotEmbed</span>(e, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">clust=</span>metaclusters, <span class="at">alpha=</span>.<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Warning in plot.xy(xy, type, ...): semi-transparency is not supported on this
## device: reported only once per page</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAABlBMVEUAAAD///+l2Z/dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAELklEQVR4nO3di3LaMBQAUen/f7od8EOmMhvJMrcouzMpCRUIztgyEEpTtrel6BvwvycQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQNBgofU1RQGOv7r4EggSCBIIEggSCBIIEggSCBIIEggSCBIJagfYnuNfu4qxAD5ynkEC1gSXTZ+aNrgsoC3Q2MO0nAlUHLkt0y2uR1+aNrv8wL1DnwJCru682oK6X+6/NG51AUPNR7CJM87zRdaxBQ5BmBnr85C4GAwV6M3DEPjYt0PXjV+O80TUf5j89b3Q+DoJ8qgEJBDUDjdi/WuaNrv2pxuH0/nmja12k959dpCsDBYKBpYpAlYFuQTBQIBroUYwGjnmiMTHQx+eNrg/ILehsYFre3uEaVB+Y9j89itUGlu8MEqgysHwwJFBlYPkGM4FqA/+yDNmApgVaf+XjUax/YMjV3ZdAkL/2gTq2oBFvk54ZaN103IJOBqbXM+6dN7ruLcg16HTgkFfMZgZqudT1eaPzcRDUA5T2Z2T3zxtd3yKdXKTPB6bi6wPzRicQ5C4G+TgI8jAPCQR172Kfmjc6n6xCvtwBCQT1rEFtF7w4b3S+aA95mIcEgvqfariLnQz0XxzCwDF3bWagIfdtYqAxQhMD+TgIBroGwUCBaKCL9PuBrkEXB4Zc3X21PpvvuOS1eaPrARrxgpBAo+aNTiBIIEggyNekIYEgHyhCAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQWFAX1MQ0HwJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBMUBVT9Eo3pzts+b3S/3/Ga9ovtu5PcAPf6r97RfLOf9//VM5xcdcDPvudqfzFyb+gxo+8TrQmPbkARazy+AHuftQC0feNN4M++52p/MvE793HmW3abYLra7nw6Dt9MSKM+8BS1bwHJafOV96UmvDBtQyvMCLavtuuCu3+eX08MmdQRKcwMVN6EGU55ulzgA5V8M9Ny60gEopyRQefp6fk67xqaTfzHQP2DpsLmUa1f+NUCvi/b2tUqUDwlmB1oXmlxuKfXHQeWBfvurPDfQlyQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkEPQHhp0/GPqXiG4AAAAASUVORK5CYII=" /><!-- --></p>
<p>Custom colors are also supported (this is colored according to the
dendrogram order):</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">topo.colors</span>(<span class="dv">24</span><span class="sc">*</span><span class="dv">24</span>, <span class="at">alpha=</span>.<span class="dv">3</span>)[Matrix<span class="sc">::</span><span class="fu">invPerm</span>(hcl<span class="sc">$</span>order)[map<span class="sc">$</span>mapping[,<span class="dv">1</span>]]]</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>EmbedSOM<span class="sc">::</span><span class="fu">PlotEmbed</span>(e, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">col=</span>colors)</span></code></pre></div>
<pre><code>## Warning in plot.xy(xy, type, ...): semi-transparency is not supported on this
## device: reported only once per page</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAABlBMVEUAAAD///+l2Z/dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAELklEQVR4nO3di3LaMBQAUen/f7od8EOmMhvJMrcouzMpCRUIztgyEEpTtrel6BvwvycQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQNBgofU1RQGOv7r4EggSCBIIEggSCBIIEggSCBIIEggSCBIJagfYnuNfu4qxAD5ynkEC1gSXTZ+aNrgsoC3Q2MO0nAlUHLkt0y2uR1+aNrv8wL1DnwJCru682oK6X+6/NG51AUPNR7CJM87zRdaxBQ5BmBnr85C4GAwV6M3DEPjYt0PXjV+O80TUf5j89b3Q+DoJ8qgEJBDUDjdi/WuaNrv2pxuH0/nmja12k959dpCsDBYKBpYpAlYFuQTBQIBroUYwGjnmiMTHQx+eNrg/ILehsYFre3uEaVB+Y9j89itUGlu8MEqgysHwwJFBlYPkGM4FqA/+yDNmApgVaf+XjUax/YMjV3ZdAkL/2gTq2oBFvk54ZaN103IJOBqbXM+6dN7ruLcg16HTgkFfMZgZqudT1eaPzcRDUA5T2Z2T3zxtd3yKdXKTPB6bi6wPzRicQ5C4G+TgI8jAPCQR172Kfmjc6n6xCvtwBCQT1rEFtF7w4b3S+aA95mIcEgvqfariLnQz0XxzCwDF3bWagIfdtYqAxQhMD+TgIBroGwUCBaKCL9PuBrkEXB4Zc3X21PpvvuOS1eaPrARrxgpBAo+aNTiBIIEggyNekIYEgHyhCAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQWFAX1MQ0HwJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBMUBVT9Eo3pzts+b3S/3/Ga9ovtu5PcAPf6r97RfLOf9//VM5xcdcDPvudqfzFyb+gxo+8TrQmPbkARazy+AHuftQC0feNN4M++52p/MvE793HmW3abYLra7nw6Dt9MSKM+8BS1bwHJafOV96UmvDBtQyvMCLavtuuCu3+eX08MmdQRKcwMVN6EGU55ulzgA5V8M9Ny60gEopyRQefp6fk67xqaTfzHQP2DpsLmUa1f+NUCvi/b2tUqUDwlmB1oXmlxuKfXHQeWBfvurPDfQlyQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkEPQHhp0/GPqXiG4AAAAASUVORK5CYII=" /><!-- --></p>
<p><code>ggplot2</code> interoperability is provided using function
<code>PlotGG</code>:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>EmbedSOM<span class="sc">::</span><span class="fu">PlotGG</span>(e, <span class="at">data=</span>data) <span class="sc">+</span> ggplot2<span class="sc">::</span><span class="fu">geom_hex</span>(<span class="at">bins=</span><span class="dv">80</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>(You may also get the ggplot-compatible data object using
<code>PlotData</code> function.)</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
